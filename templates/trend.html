<!-- file: templates/trend.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Market Intelligence Trends</title>
  <!-- Load Plotly from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/plotly.js@2.20.0/dist/plotly.min.js"></script>
</head>
<body>
  <h1>Filter Min/Max/Avg Price Trends</h1>
  <form method="POST" action="/trend">
    <label>Market:</label>
    <select name="market">
      <option value="All">All</option>
      {% for m in all_markets %}
        <option value="{{m}}" {% if selected_market == m %}selected{% endif %}>{{m}}</option>
      {% endfor %}
    </select>

    <label>Variety:</label>
    <select name="variety">
      <option value="All">All</option>
      {% for v in all_varieties %}
        <option value="{{v}}" {% if selected_variety == v %}selected{% endif %}>{{v}}</option>
      {% endfor %}
    </select>

    <label>Grade:</label>
    <select name="grade">
      <option value="All">All</option>
      {% for g in all_grades %}
        <option value="{{g}}" {% if selected_grade == g %}selected{% endif %}>{{g}}</option>
      {% endfor %}
    </select>

    <button type="submit">Show Trends</button>
  </form>

  <hr/>

  {% if plot_html %}
    <!-- Insert the Plotly figure -->
    {{ plot_html|safe }}
  {% else %}
    <p>Pick a Market, Variety, Grade, then click "Show Trends".</p>
  {% endif %}
</body>
</html>
